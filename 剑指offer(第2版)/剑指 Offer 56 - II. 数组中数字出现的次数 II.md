## 剑指 Offer 56 - II. 数组中数字出现的次数 II

解题核心：统计所有数字的各二进制位中 1 的出现次数，并将每一位对 3 求余，最终所有位的结果就是只出现一次的数字

### 1.有限状态自动机+位运算

每一位求余后有三种结果状态：0,1,2，用二进制表示成00,01,10，这两位分别为two,one

再根据状态转换表导出状态转换的计算公式，同时也要用到位运算：

> 异或运算：`x ^ 0 = x` ， `x ^ 1 = ~x`
>
> 与运算：`x & 0 = 0` ， `x & 1 = x`

以上是对数字的二进制中 “一位” 的分析，而其他 31 位具有相同的运算规则，因此可将以上公式直接套用在 32 位数上

```javascript
/**
 * @param {number[]} nums
 * @return {number}
 */
var singleNumber = function(nums) {
    let ones=0, twos=0;
    for(let num of nums){
        ones=ones ^ num & ~twos;
        twos=twos ^ num & ~ones;
    }
    return ones;
};
```

### 2. 遍历统计

建立一个长度为 32 的数组，统计每一位中 1 出现的次数

判断最右位是否为1：`num&1`，然后右移一位：`num>>>=1`，再进行下一位的判断

将数组中各个数对 3 求余

**这个效率较低，推荐方法1**